(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["system-user"],{"1f34":function(e,t,n){"use strict";n.r(t);n("b0c0");var c=n("7a23"),o=function(e){return Object(c["pushScopeId"])("data-v-1943767a"),e=e(),Object(c["popScopeId"])(),e},r={class:"custom-tree-node"},a={class:"left-panel"},i=Object(c["createTextVNode"])("新增"),l=Object(c["createTextVNode"])("删除"),s=Object(c["createTextVNode"])("导出"),u={class:"right-panel"},d={class:"right-panel-search"},h=Object(c["createTextVNode"])(" 更多筛选"),b=o((function(){return Object(c["createElementVNode"])("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)})),f=Object(c["createTextVNode"])("启用"),m=Object(c["createTextVNode"])("停用"),p=o((function(){return Object(c["createElementVNode"])("i",{class:"el-icon-s-custom"},null,-1)})),j=Object(c["createTextVNode"])("查看"),O=Object(c["createTextVNode"])("更新缓存"),w=Object(c["createTextVNode"])(" 更多"),C=o((function(){return Object(c["createElementVNode"])("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)})),x=Object(c["createTextVNode"])("编辑"),v=Object(c["createTextVNode"])("设置首页"),g=Object(c["createTextVNode"])("更新缓存"),V=Object(c["createTextVNode"])("初始化密码"),k=Object(c["createTextVNode"])("删除"),y=Object(c["createTextVNode"])("恢复"),N=Object(c["createTextVNode"])("删除");function _(e,t,n,o,_,D){var $=Object(c["resolveComponent"])("el-input"),P=Object(c["resolveComponent"])("el-header"),T=Object(c["resolveComponent"])("el-tree"),B=Object(c["resolveComponent"])("el-main"),S=Object(c["resolveComponent"])("el-container"),R=Object(c["resolveComponent"])("el-aside"),q=Object(c["resolveComponent"])("el-button"),I=Object(c["resolveComponent"])("el-tooltip"),E=Object(c["resolveComponent"])("el-option"),A=Object(c["resolveComponent"])("el-select"),F=Object(c["resolveComponent"])("el-form-item"),U=Object(c["resolveComponent"])("el-date-picker"),z=Object(c["resolveComponent"])("el-form"),H=Object(c["resolveComponent"])("el-popover"),Y=Object(c["resolveComponent"])("el-table-column"),J=Object(c["resolveComponent"])("el-avatar"),L=Object(c["resolveComponent"])("el-switch"),M=Object(c["resolveComponent"])("el-dropdown-item"),G=Object(c["resolveComponent"])("el-dropdown-menu"),K=Object(c["resolveComponent"])("el-dropdown"),Q=Object(c["resolveComponent"])("yjTable"),W=Object(c["resolveComponent"])("save-dialog"),X=Object(c["resolveComponent"])("homepage-dialog"),Z=Object(c["resolveDirective"])("loading"),ee=Object(c["resolveDirective"])("auth");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createVNode"])(S,null,{default:Object(c["withCtx"])((function(){return[Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(R,{width:"220px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(S,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(P,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])($,{placeholder:"输入关键字进行过滤",modelValue:_.rolesFilterText,"onUpdate:modelValue":t[0]||(t[0]=function(e){return _.rolesFilterText=e}),clearable:""},null,8,["modelValue"])]})),_:1}),Object(c["createVNode"])(B,{class:"nopadding"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(T,{ref:"roles",class:"menu","node-key":"id","node-label":"name",data:_.roles,"current-node-key":0,"highlight-current":!0,"expand-on-click-node":!1,"filter-node-method":D.rolesFilterNode,onNodeClick:D.rolesClick},{default:Object(c["withCtx"])((function(e){var t=e.data;return[Object(c["createElementVNode"])("span",r,[Object(c["createElementVNode"])("span",null,Object(c["toDisplayString"])(t.name),1)])]})),_:1},8,["data","filter-node-method","onNodeClick"])]})),_:1})]})),_:1})]})),_:1})),[[Z,e.showRolesloading]]),Object(c["createVNode"])(S,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(P,null,{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("div",a,[Object(c["createVNode"])(q,{icon:"el-icon-plus",type:"primary",onClick:D.add},{default:Object(c["withCtx"])((function(){return[i]})),_:1},8,["onClick"]),Object(c["createVNode"])(q,{type:"danger",plain:"",icon:"el-icon-delete",disabled:0==_.selection.length,onClick:D.batchDel},{default:Object(c["withCtx"])((function(){return[l]})),_:1},8,["disabled","onClick"]),Object(c["createVNode"])(q,{icon:"el-icon-download",onClick:D.exportExcel},{default:Object(c["withCtx"])((function(){return[s]})),_:1},8,["onClick"])]),Object(c["createElementVNode"])("div",u,[Object(c["createElementVNode"])("div",d,[Object(c["createVNode"])($,{modelValue:_.queryParams.username,"onUpdate:modelValue":t[1]||(t[1]=function(e){return _.queryParams.username=e}),placeholder:"搜索用户名",clearable:""},null,8,["modelValue"]),Object(c["createVNode"])(I,{class:"item",effect:"dark",content:"搜索",placement:"top"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,{type:"primary",icon:"el-icon-search",onClick:D.handlerSearch},null,8,["onClick"])]})),_:1}),Object(c["createVNode"])(I,{class:"item",effect:"dark",content:"清空条件",placement:"top"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,{icon:"el-icon-refresh",onClick:D.resetSearch},null,8,["onClick"])]})),_:1}),Object(c["createVNode"])(H,{placement:"bottom-end",width:450,trigger:"click"},{reference:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,{type:"text",onClick:t[2]||(t[2]=function(e){return _.povpoerShow=!_.povpoerShow})},{default:Object(c["withCtx"])((function(){return[h,b]})),_:1})]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(z,{"label-width":"80px"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(F,{label:"状态",prop:"status"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(A,{size:"small",modelValue:_.queryParams.status,"onUpdate:modelValue":t[3]||(t[3]=function(e){return _.queryParams.status=e}),clearable:"",placeholder:"用户状态"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(E,{label:"启用",value:"0"},{default:Object(c["withCtx"])((function(){return[f]})),_:1}),Object(c["createVNode"])(E,{label:"停用",value:"1"},{default:Object(c["withCtx"])((function(){return[m]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),Object(c["createVNode"])(F,{label:"创建时间"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(U,{clearable:"",size:"small",modelValue:_.dateRange,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _.dateRange=e}),type:"daterange","range-separator":"至",onChange:D.handleDateChange,"value-format":"YYYY-MM-DD","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue","onChange"])]})),_:1})]})),_:1})]})),_:1})])])]})),_:1}),Object(c["createVNode"])(B,{class:"nopadding"},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(Q,{ref:"table",apiObj:_.apiObj,params:_.queryParams,column:_.column,showRecycle:!0,onSelectionChange:D.selectionChange,onSwitchData:D.switchData,stripe:"",remoteSort:"",remoteFilter:""},{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(Y,{type:"selection",width:"50"}),Object(c["createVNode"])(Y,{label:"头像",width:"60"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(J,{src:e.row.icon_path.full_path,size:"small",onError:t[5]||(t[5]=function(){return!0})},{default:Object(c["withCtx"])((function(){return[p]})),_:2},1032,["src"])]})),_:1}),Object(c["createVNode"])(Y,{label:"登录账号",prop:"username",sortable:"custom",width:"130"}),Object(c["createVNode"])(Y,{label:"昵称",prop:"nickname",width:"120"}),Object(c["createVNode"])(Y,{label:"邮箱",prop:"email",width:"220"}),Object(c["createVNode"])(Y,{label:"状态",prop:"status",width:"100"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(L,{modelValue:e.row.status,"onUpdate:modelValue":function(t){return e.row.status=t},onChange:function(t){return D.handleStatus(t,e.row)},"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue","onChange"])]})),_:1}),Object(c["createVNode"])(Y,{label:"用户类型",prop:"user_type",width:"80"},{default:Object(c["withCtx"])((function(e){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])("100"===e.row.user_type?"系统用户":"其他类型"),1)]})),_:1}),Object(c["createVNode"])(Y,{label:"创建时间",prop:"created_at",width:"150",sortable:"custom"}),_.isRecycle?(Object(c["openBlock"])(),Object(c["createBlock"])(Y,{key:1,label:"操作",fixed:"right",align:"right",width:"130"},{default:Object(c["withCtx"])((function(e){return[Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(q,{type:"text",size:"small",onClick:function(t){return D.recovery(e.row.id)}},{default:Object(c["withCtx"])((function(){return[y]})),_:2},1032,["onClick"])),[[ee,["system:user:recovery"]]]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(q,{type:"text",size:"small",onClick:function(t){return D.deletes(e.row.id)}},{default:Object(c["withCtx"])((function(){return[N]})),_:2},1032,["onClick"])),[[ee,["system:user:realDelete"]]])]})),_:1})):(Object(c["openBlock"])(),Object(c["createBlock"])(Y,{key:0,label:"操作",fixed:"right",align:"right",width:"130"},{default:Object(c["withCtx"])((function(e){return[Object(c["createVNode"])(q,{type:"text",size:"small",onClick:function(t){return D.show(e.row,e.$index)}},{default:Object(c["withCtx"])((function(){return[j]})),_:2},1032,["onClick"]),"superAdmin"===e.row.username?Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(q,{key:0,type:"text",size:"small",onClick:function(t){return D.clearCache(e.row)}},{default:Object(c["withCtx"])((function(){return[O]})),_:2},1032,["onClick"])),[[ee,["system:user:cache"]]]):Object(c["createCommentVNode"])("",!0),"superAdmin"!==e.row.username?(Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:1},{dropdown:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(G,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(M,{onClick:function(t){return D.edit(e.row,e.$index)}},{default:Object(c["withCtx"])((function(){return[x]})),_:2},1032,["onClick"]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(M,{onClick:function(t){return D.setHomepage(e.row)}},{default:Object(c["withCtx"])((function(){return[v]})),_:2},1032,["onClick"])),[[ee,["system:user:homePage"]]]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(M,{onClick:function(t){return D.clearCache(e.row)}},{default:Object(c["withCtx"])((function(){return[g]})),_:2},1032,["onClick"])),[[ee,["system:user:cache"]]]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(M,{onClick:function(t){return D.initUserPassword(e.row.id)}},{default:Object(c["withCtx"])((function(){return[V]})),_:2},1032,["onClick"])),[[ee,["system:user:initUserPassword"]]]),Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createBlock"])(M,{onClick:function(t){return D.deletes(e.row.id)},divided:""},{default:Object(c["withCtx"])((function(){return[k]})),_:2},1032,["onClick"])),[[ee,["system:user:delete"]]])]})),_:2},1024)]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(q,{type:"text",size:"small"},{default:Object(c["withCtx"])((function(){return[w,C]})),_:1})]})),_:2},1024)):Object(c["createCommentVNode"])("",!0)]})),_:1}))]})),_:1},8,["apiObj","params","column","onSelectionChange","onSwitchData"])]})),_:1})]})),_:1})]})),_:1}),_.dialog.save?(Object(c["openBlock"])(),Object(c["createBlock"])(W,{key:0,ref:"saveDialog",onSuccess:D.handleSuccess,onClosed:t[6]||(t[6]=function(e){return _.dialog.save=!1})},null,8,["onSuccess"])):Object(c["createCommentVNode"])("",!0),_.dialog.homepage?(Object(c["openBlock"])(),Object(c["createBlock"])(X,{key:1,ref:"homepageDialog",onSuccess:D.handleSuccess,onClosed:t[7]||(t[7]=function(e){return _.dialog.homepage=!1})},null,8,["onSuccess"])):Object(c["createCommentVNode"])("",!0)],64)}var D=n("1da1"),$=(n("96cf"),n("4de4"),n("d3b7"),n("d81d"),n("a15b"),n("99af"),{name:"system:user",components:{},data:function(){return{dialog:{save:!1,homepage:!1},column:[{label:"用户ID",prop:"id",width:"150",hide:!0},{label:"手机",prop:"phone",width:"120",hide:!0},{label:"最后登录时间",prop:"login_time",width:"200",hide:!0},{label:"最后登录IP",prop:"login_ip",width:"180",hide:!0}],povpoerShow:!1,dateRange:"",showRolesLoading:!1,rolesFilterText:"",roles:[],apiObj:this.$HTTP().url("admin/system/admin/lists"),selection:[],queryParams:{username:void 0,roles_id:void 0,maxDate:void 0,minDate:void 0,status:void 0},isRecycle:!1}},watch:{rolesFilterText:function(e){this.$refs.roles.filter(e)}},mounted:function(){this.getRoles()},methods:{add:function(){var e=this;this.$modalForm(this.$HTTP().post("admin/system/admin/form")).then((function(t){e.$refs.table.upData()}))},edit:function(e){var t=this,n=e.id;this.$modalForm(this.$HTTP().params({id:n}).post("admin/system/admin/form")).then((function(e){t.$refs.table.upData()}))},show:function(e){var t=this;this.dialog.save=!0,this.$nextTick((function(){t.$refs.saveDialog.open("show").setData(e)}))},batchDel:function(){var e=this;return Object(D["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$confirm("确定删除选中的 ".concat(e.selection.length," 项吗？"),"提示",{type:"warning"}).then((function(){var t=e.$loading(),n=[];e.selection.map((function(e){return n.push(e.id)})),e.isRecycle?e.$API.user.realDeletes(n.join(",")).then():e.$API.user.deletes(n.join(",")).then(),e.$refs.table.upData(e.queryParams),t.close(),e.$message.success("操作成功")}));case 2:case"end":return t.stop()}}),t)})))()},deletes:function(e){var t=this;return Object(D["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$confirm("确定删除该用户吗？","提示",{type:"warning"}).then((function(){var n=t.$loading();t.isRecycle?t.$API.user.realDeletes(e).then((function(){t.$refs.table.upData(t.queryParams)})):t.$API.user.deletes(e).then((function(){t.$refs.table.upData(t.queryParams)})),n.close(),t.$message.success("操作成功")})).catch((function(){}));case 2:case"end":return n.stop()}}),n)})))()},recovery:function(e){var t=this;return Object(D["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$API.user.recoverys(e).then((function(e){t.$message.success(e.message),t.$refs.table.upData(t.queryParams)}));case 2:case"end":return n.stop()}}),n)})))()},selectionChange:function(e){this.selection=e},getRoles:function(){var e=this;return Object(D["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$HTTP().post("admin/system/roles/lists").then((function(t){t.data.unshift({id:0,name:"全部"}),e.roles=t.data,e.showRolesloading=!1}));case 2:case"end":return t.stop()}}),t)})))()},rolesFilterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},rolesClick:function(e){if(console.log("rolesClick"),this.queryParams.roles_id!=e.id){if(void 0===e.id)this.queryParams.roles_id=e.id;else{var t=[e.id],n=function e(n){n.map((function(n){n.children&&n.children.length>0?e(n.children):t.push(n.id)}))};e.children&&e.children.length>0&&n(e.children),this.queryParams.roles_id=t.join(",")}this.$refs.table.upData(this.queryParams)}},initUserPassword:function(e){var t=this;this.$confirm("确定要将用户密码设置为：123456","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$API.user.initUserPassword(e).then((function(){t.$message.success("用户密码初始化成功")}))}))},exportExcel:function(){var e=this;this.$API.user.exportExcel(this.queryParams).then((function(t){e.$TOOL.download(t)}))},setHomepage:function(e){var t=this;this.dialog.homepage=!0,this.$nextTick((function(){t.$refs.homepageDialog.open().setData(e)}))},clearCache:function(e){var t=this;this.$API.user.clearCache({id:e.id}).then((function(){t.$message.success("该用户缓存已清空")}))},handleDateChange:function(e){null!==e&&(this.queryParams.minDate=e[0],this.queryParams.maxDate=e[1])},handlerSearch:function(){this.$refs.table.upData(this.queryParams)},switchData:function(e){this.isRecycle=e},handleStatus:function(e,t){var n=this;console.log("handleStatus");var c="0"===t.status?"0":"1",o="0"===t.status?"启用":"停用";this.$confirm("确认要".concat(o," ").concat(t.username," 用户吗？"),"提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){n.$API.user.changeStatus({id:t.id,status:c}).then((function(){n.$message.success(o+"成功")}))})).catch((function(){t.status="0"===t.status?"1":"0"}))},resetSearch:function(){this.queryParams={username:void 0,roles_id:void 0,maxDate:void 0,minDate:void 0,status:void 0},this.$refs.table.upData(this.queryParams)},handleSuccess:function(){this.$refs.table.upData(this.queryParams)}}}),P=(n("f68d"),n("6b0d")),T=n.n(P);const B=T()($,[["render",_],["__scopeId","data-v-1943767a"]]);t["default"]=B},da65:function(e,t,n){},f68d:function(e,t,n){"use strict";n("da65")}}]);